


WITH numbers AS (
    SELECT generate_series as n FROM table(generate_series(0, @len_items_stg_organizations, 1)) 
)
SELECT 
    UUID() as organizations_hk,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].IndividualnyyPredprinimatel')) AS VARCHAR(250)) AS individualnyy_predprinimatel,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_Audit')) AS VARCHAR(250)) AS rc_audit,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_Auditor')) AS VARCHAR(250)) AS rc_auditor,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_VidInostrannoyStruktury')) AS VARCHAR(250)) AS rc_vid_inostrannoy_struktury,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_VidOrganizatsiiPoUmolchaniyu')) AS VARCHAR(250)) AS rc_vid_organizatsii_po_umolchaniyu,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_VidOtkloneniyaKontroliruemogoZnacheniya')) AS VARCHAR(250)) AS rc_vid_otkloneniya_kontroliruemogo_znacheniya,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_GlavnyyBukhgalterFIO')) AS VARCHAR(250)) AS rc_glavnyy_bukhgalter_fio,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_GorodStranaMezhdunarodnyy')) AS VARCHAR(250)) AS rc_gorod_strana_mezhdunarodnyy,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_GruppaKontragenta')) AS VARCHAR(250)) AS rc_gruppa_kontragenta,
    str_to_date(CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_DataPrekrashcheniyaDeyatelnosti')) AS VARCHAR(250)), '%Y-%m-%dT%H:%i:%s') AS rc_data_prekrashcheniya_deyatelnosti,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_Divizion')) AS VARCHAR(250)) AS rc_divizion,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_ZakupkaPoFZ223')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_zakupka_po_fz223,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_InostrannayaStrukturaBezObrazovaniyaYurLitsa')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_inostrannaya_struktura_bez_obrazovaniya_yur_litsa,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_InostrannyyNalogovyyRezident')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_inostrannyy_nalogovyy_rezident,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_IPImya')) AS VARCHAR(250)) AS rc_ipi_ima,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_IPOtchestvo')) AS VARCHAR(250)) AS rc_ip_otch,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_IPFamiliya')) AS VARCHAR(250)) AS rc_ip_fam,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_IspolzovatStrokuPlanaZakupok')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_ispolzovat_stroku_plana_zakupok,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_KodInykhVidovDeyatelnostiNFO')) AS VARCHAR(250)) AS rc_kod_inykh_vidov_deyatelnosti_nfo,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_KodNalogoplatelshchikaInostrannyy')) AS VARCHAR(250)) AS rc_kod_nalogoplatelshchika_inostrannyy,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_KodOsnovnogoVidaDeyatelnostiNFO')) AS VARCHAR(250)) AS rc_kod_osnovnogo_vida_deyatelnosti_nfo,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_Makroregion')) AS VARCHAR(250)) AS rc_makroregion,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieBE')) AS VARCHAR(250)) AS rc_naimenovanie_be,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieInykhVidovDeyatelnostiNFO')) AS VARCHAR(250)) AS rc_naimenovanie_inykh_vidov_deyatelnosti_nfo,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieOrganizatsiiNaAngliyskomYazyke')) AS VARCHAR(250)) AS rc_naimenovanie_organizatsii_na_angliyskom_yazyke,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieOsnovnogoVidaDeyatelnostiNFO')) AS VARCHAR(250)) AS rc_naimenovanie_osnovnogo_vida_deyatelnosti_nfo,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieRegistriruyushchegoOrgana')) AS VARCHAR(250)) AS rc_naimenovanie_registriruyushchego_organa,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NekreditnayaFinansovayaOrganizatsiya')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_necreditnaya_finansovaya_organizatsiya,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_OrganizatsiyaDeystvuyushchaya')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_organizatsiya_deystvuyushchaya,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_OsnovaniePrekrashcheniyaDeyatelnosti')) AS VARCHAR(250)) AS rc_osnovanie_prekrashcheniya_deyatelnosti,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_OsnovnoyBankovskiySchet')) AS VARCHAR(250)) AS rc_osnovnoy_bankovskiy_schet,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_PoligonZhD')) AS VARCHAR(250)) AS rc_poligon_zh_d,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_RegionRossii')) AS VARCHAR(250)) AS rc_region_rossii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_RegistriruyushchiyOrgan')) AS VARCHAR(250)) AS rc_registriruyushchiy_organ,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_RukovoditelOrganizatsiiDolzhnost')) AS VARCHAR(250)) AS rc_rukovoditel_organizatsii_dolzhnost,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_RukovoditelOrganizatsiiFIO')) AS VARCHAR(250)) AS rc_rukovoditel_organizatsii_fio,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_SvedeniyaOLitsenzii')) AS VARCHAR(250)) AS rc_svedeniya_o_litsenzii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_TarifnayaZona')) AS VARCHAR(250)) AS rc_tarifnaya_zona,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_TipElementa')) AS VARCHAR(250)) AS rc_tip_elementa,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_FormatTsFO')) AS VARCHAR(250)) AS rc_format_ts_fo,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_FRMO_OrgID')) AS VARCHAR(250)) AS rc_frmo_org_id,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_EtoBank')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_eto_bank,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_EtoIndividualnyyPredprinimatel')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_eto_individualnyy_predprinimatel,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_EtoMezhdunarodnyyKholding')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_eto_mezhdunarodnyy_kholding,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_EtoNKO')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_eto_nko,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_EtoSamozanyatyy')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_eto_samozanyatyy,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_EtoStrakhovayaKompaniya')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS rc_eto_strakhovaya_kompaniya,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_AdresMezhdunarodnyy')) AS VARCHAR(250)) AS rc_adres_mezhdunarodnyy,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_KodOKVED2')) AS VARCHAR(250)) AS rc_kod_okved2,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].VidObmenaSKontroliruyushchimiOrganami')) AS VARCHAR(250)) AS vid_obmena_s_kontroliruyushchimi_organami,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].Voenkomat')) AS VARCHAR(250)) AS voenkomat,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].ValyutaReglamentirovannogoUcheta')) AS VARCHAR(250)) AS valyuta_reglamentirovannogo_ucheta,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].GrafikRaboty')) AS VARCHAR(250)) AS grafik_raboty,
    str_to_date(CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].DataRegistratsii')) AS VARCHAR(250)), '%Y-%m-%dT%H:%i:%s') AS data_registratsii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].DopolnitelnyyKodFSS')) AS VARCHAR(250)) AS dopolnitelnyy_kod_fss,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].DopuskayutsyaVzaimoraschetyCherezGolovnuyuOrganizatsiyu')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS dopuskayutsya_vzaimoraschety_cherez_golovnuyu_organizatsiyu,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].EstObosoblennyePodrazdeleniya')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS est_obosoblennye_podrazdeleniya,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].ZaregistrirovanVOEZ')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS zaregistrirovan_voez,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].INN')) AS VARCHAR(250)) AS inn,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KPP')) AS VARCHAR(250)) AS kpp,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].IPKodPodchinennostiFSS')) AS VARCHAR(250)) AS ip_kod_podchinennosti_fss,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].IPRegistratsionnyyNomerPFR')) AS VARCHAR(250)) AS ip_registratsionnyy_nomer_pfr,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].IPRegistratsionnyyNomerTFOMS')) AS VARCHAR(250)) AS ip_registratsionnyy_nomer_tfoms,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].IPRegistratsionnyyNomerFSS')) AS VARCHAR(250)) AS ip_registratsionnyy_nomer_fss,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodVStraneRegistratsii')) AS VARCHAR(250)) AS kod_v_strane_registratsii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodNalogovogoOrgana')) AS VARCHAR(250)) AS kod_nalogovogo_organa,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodNalogovogoOrganaPoluchatelya')) AS VARCHAR(250)) AS kod_nalogovogo_organa_poluchatelya,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodOKVED')) AS VARCHAR(250)) AS kod_okved,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodOKVED2')) AS VARCHAR(250)) AS kod_okved2,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodOKOPF')) AS VARCHAR(250)) AS kod_okopf,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodOKFS')) AS VARCHAR(250)) AS kod_okfs,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodOrganaPFR')) AS VARCHAR(250)) AS kod_organa_pfr,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodOrganaFSGS')) AS VARCHAR(250)) AS kod_organa_fsgs,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodPodchinennostiFSS')) AS VARCHAR(250)) AS kod_podchinennosti_fss,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodPoOKATO')) AS VARCHAR(250)) AS kod_po_okato,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KodPoOKPO')) AS VARCHAR(250)) AS kod_po_okpo,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].Kontragent')) AS VARCHAR(250)) AS kontragent,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NaimenovanieSokrashchennoe')) AS VARCHAR(250)) AS naimenovanie_sokrashchennoe,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].KrupneyshiyNalogoplatelshchik')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS krupneyshiy_nalogoplatelshchik,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NaborSvoystv')) AS VARCHAR(250)) AS nabor_svoystv,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NaimenovanieInostrOrganizatsii')) AS VARCHAR(250)) AS naimenovanie_inostr_organizatsii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].OGRN')) AS VARCHAR(250)) AS ogrn,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NaimenovanieNalogovogoOrgana')) AS VARCHAR(250)) AS naimenovanie_nalogovogo_organa,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NaimenovanieOrganizatsii')) AS VARCHAR(250)) AS naimenovanie_organizatsii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].Prefiks')) AS VARCHAR(250)) AS prefiks,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NaimenovanieTerritorialnogoOrganaPFR')) AS VARCHAR(250)) AS naimenovanie_territorialnogo_organa_pfr,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NaimenovanieTerritorialnogoOrganaFSS')) AS VARCHAR(250)) AS naimenovanie_territorialnogo_organa_fss,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NeZapolnyatPodrazdeleniyaVMeropriyatiyakhTrudovoyDeyatelnosti')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS ne_zapolnyat_podrazdeleniya_v_meropriyatiyakh_trudovoy_deyatelnosti,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].ObmenKatalogOtpravkiDannykhOtchetnosti')) AS VARCHAR(250)) AS obmen_katalog_otpravki_dannykh_otchetnosti,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].ObmenKatalogProgrammyElektronnoyPochty')) AS VARCHAR(250)) AS obmen_katalog_programmy_elektronnoy_pochty,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].ObmenKodAbonenta')) AS VARCHAR(250)) AS obmen_kod_abonenta,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].ObosoblennoePodrazdelenie')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS obosoblennoe_podrazdelenie,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].GolovnayaOrganizatsiya')) AS VARCHAR(250)) AS golovnaya_organizatsiya,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].OtdelenieInostrannoyOrganizatsii')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS otdelenie_inostrannoy_organizatsii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].PolnoeNaimenovanie')) AS VARCHAR(250)) AS polnoe_naimenovanie,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].NaimenovanieMezhdunarodnoe')) AS VARCHAR(250)) AS naimenovanie_mezhdunarodnoe,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].PrimenyatRayonnyyKoeffitsient')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS primenyat_rayonnyy_koeffitsient,
    CASE WHEN CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].PrimenyatSevernuyuNadbavku')) AS VARCHAR(10)) = 'true' THEN 1 ELSE 0 END AS primenyat_severnuyu_nadbavku,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].ProtsentSevernoyNadbavki')) AS FLOAT) AS protsent_severnoy_nadbavki,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].RayonnyyKoeffitsient')) AS FLOAT) AS rayonnyy_koeffitsient,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].RayonnyyKoeffitsientRF')) AS FLOAT) AS rayonnyy_koeffitsient_rf,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].RegistratsionnyyNomerPFR')) AS VARCHAR(250)) AS registratsionnyy_nomer_pfr,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].RegistratsionnyyNomerTFOMS')) AS VARCHAR(250)) AS registratsionnyy_nomer_tfoms,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].RegistratsionnyyNomerFSS')) AS VARCHAR(250)) AS registratsionnyy_nomer_fss,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].RegistratsiyaVNalogovomOrgane')) AS VARCHAR(250)) AS registratsiya_v_nalogovom_organe,
    str_to_date(CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].SvidetelstvoDataVydachi')) AS VARCHAR(250)), '%Y-%m-%dT%H:%i:%s') AS svidetelstvo_data_vydachi,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].SvidetelstvoSeriyaNomer')) AS VARCHAR(250)) AS svidetelstvo_seriya_nomer,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].StranaPostoyannogoMestonakhozhdeniya')) AS VARCHAR(250)) AS strana_postoyannogo_mestonakhozhdeniya,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].StranaRegistratsii')) AS VARCHAR(250)) AS strana_registratsii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].StranaRegistratsiiInostrannoyOrganizatsii')) AS VARCHAR(250)) AS strana_registratsii_inostrannoy_organizatsii,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].UchetnayaZapisObmena')) AS VARCHAR(250)) AS uchetaya_zapis_obmena,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].FaylLogotip')) AS VARCHAR(250)) AS fayl_logotip,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].FaylFaksimilnayaPechat')) AS VARCHAR(250)) AS fayl_faksimilnaya_pechat,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].TsifrovoyIndeksObosoblennogoPodrazdeleniya')) AS INT) AS tsifrovoy_indeks_obosoblennogo_podrazdeleniya,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].YuridicheskoeFizicheskoeLitso')) AS VARCHAR(250)) AS yuridicheskoe_fizicheskoe_litso,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].YurFizLitso')) AS VARCHAR(250)) AS yur_fiz_litso,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieOKVED2')) AS VARCHAR(250)) AS rc_naimenovanie_okved2,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_KodOKTMO')) AS VARCHAR(250)) AS rc_kod_oktmo,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieOKVED')) AS VARCHAR(250)) AS rc_naimenovanie_okved,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieOKOPF')) AS VARCHAR(250)) AS rc_naimenovanie_okopf,
    CAST(json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, '].rc_NaimenovanieOKFS')) AS VARCHAR(250)) AS rc_naimenovanie_okfs,
    src.src_sys_id,
    CURRENT_TIMESTAMP as load_dttm
FROM iceberg.rzdm.stg_organizations AS src
CROSS JOIN numbers AS n
WHERE src.`values` IS NOT NULL
  AND json_query(parse_json(src.`values`), CONCAT('$[0].Items[', n.n, ']')) IS NOT NULL;